<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>my page</title>
    <meta name="description" content="">
    <meta name="author" content="Administrator">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="css/reset.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style4_myPage.css">
    <script src="./js/jquery.js"></script>
    <script type="text/javascript" src="js/iscroll.js"></script>
    <script type="text/javascript" src="js/navbarscroll.js"></script>
    <script type="text/javascript" src="js/jquery-confirm.js"></script>

    <script src="js/main.js"></script>

    <style>
      .where {
          display: block;
          margin: 25px 15px;
          font-size: 11px;
          color: #000;
          text-decoration: none;
          font-family: verdana;
          font-style: italic;
      }
      
      .filebox input[type="file"] {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          border: 0;
      }
    
      
      .filebox label {
          display: inline-block;
          padding: .5em .75em;
          color: #999;
          font-size: inherit;
          line-height: normal;
          vertical-align: middle;
          background-color: #fdfdfd;
          cursor: pointer;
          border: 1px solid #ebebeb;
          border-bottom-color: #e2e2e2;
          border-radius: .25em;
      }
      

      /* named upload */
      
      .filebox .upload-name {
          display: inline-block;
          padding: .5em .75em;
          font-size: inherit;
          font-family: inherit;
          line-height: normal;
          vertical-align: middle;
          background-color: #f5f5f5;
          border: 1px solid #ebebeb;
          border-bottom-color: #e2e2e2;
          border-radius: .25em;
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
      }
    
      .filebox.bs3-primary label {
          color: #fff;
          background-color: #337ab7;
          border-color: #2e6da4;
          margin-left: 15px;
      }
      
    </style>
  </head>
  <body>
    <div id="wrap">
      <!-- home fadeOut 시작 -->
      <div id="prompt"><p>prompt</p></div>

      <div id="main">
        <div id="main_header">
          <div class="inner">
              <div class="text" style=" height: 34px; line-height: 34px;">마이페이지</div>
          </div>
        </div>
        <div id="main_contents">
          <div id="title"></div>
          <div id="container">
            <ul>
              <li onclick=order_delivery();>
                <p class="icon"><img src="img/shipping-02.png" alt="주문배송 아이콘"></p>
                <p class="text">주문 · 배송</p>
              </li>
              <li onclick=purchase_history();>
                <p class="icon"><img src="img/record-02.png" alt="구매내역 아이콘"></p>
                <p class="text">구매내역</p>
              </li>
              <li onclick=notice_history();>
                <p class="icon"><img src="img/question-02.png.png" alt="자주 묻는 질문 아이콘"></p>
                <p class="text">자주 묻는 질문</p>
              </li>
              <li onclick=notice_history_2();>
                <p class="icon"><img src="img/notice-02.png" alt="공지사항 아이콘"></p>
                <p class="text">공지사항</p>
              </li>
              <li onclick="my_information();">
                <p class="icon"><img src="img/Information-02.png" alt="나의 정보 아이콘"></p>
                <p class="text">나의 정보</p>
              </li>
            </ul>
          </div>
        </div>
        <div id="main_footer">
          <ul>
            <li><a href="shoppingMall1_home.html"><img id="img1" src="img/mainBtn-01-2.png"></a></li>
            <li><a href="shoppingMall2_mall.html"><img id="img1" src="img/mainBtn-02-2.png"></a></li>
            <li><a href="shoppingMall3_collect.html"><img id="img1" src="img/mainBtn-03-2.png"></a></li>
            <li><a><img id="img1" src="img/mainBtn-04-2-1.png"></a></li>
          </ul>
        </div>
      </div>

      <!-- my page 주문 · 배송 시작 -->
      <div id="delivery">
        <div id="delivery_header">
          <div class="inner">
            <p><img src="img/chevron-left-02.png" alt="돌아가기"></p>
            <div class="text">주문 · 배송</div>
          </div>
        </div>

        <div id="delivery_contents"></div>
      </div>
      <!-- my page 주문 · 배송 끝 -->

      <!-- my page 주문 · 배송에 상세내역 시작 -->
      <div id="purchaseDetails">
        <div id="purchaseDetails_header">
          <div class="inner">
            <p><img src="img/chevron-left-02.png" alt="돌아가기"></p>
            <div class="text">상세 내역</div>
          </div>
        </div>

        <div id="purchaseDetails_contents"></div>
      </div>
      <!-- my page 주문 · 배송에 상세내역 끝 -->

      <!-- my page 주문 · 배송에 반품요청 시작 -->
      <div id="return">
        <div id="return_header">
          <div class="inner">
            <p><img src="img/chevron-left-02.png" alt="돌아가기"></p>
            <div class="text">반품요청</div>
          </div>
        </div>

        <div id="return_contents"></div>
      </div>
      <!-- my page 주문 · 배송에 반품요청 끝 -->

      <!-- my page 주문 · 배송에 반품정보 시작 -->
      <div id="returnInfo">
        
        <div id="returnInfo_header">
          <div class="inner">
            <p><img src="img/chevron-left-02.png" alt="돌아가기"></p>
            <div class="text">반품정보</div>
          </div>
        </div>

        <div id="returnInfo_contents">

          <div class="product">
            <div class="tit">
              <p>반품상품</p>
            </div>

            <div class="product_list">
              <div class="details">
                <div class="product_img">
                      <img src="img/210-1.png" alt="상품이미지">
                </div>

                <div class="product_text">
                  <div class="text_1">
                    <div>
                      <p>2020.09.24  10:09:32</p>
                      <p>상품이름상품이름상품상품이름상품이름상품상품이름상품이름상품상품이름상품이름상품상품이름상품이름상품상품이름상품이름상품상품이름상품이름상품상품이름상품이름상품</p>
                      <p>오트밀벨이지</p>
                    </div>
                  </div>
                  
                  <div class="text_2">
                    <p>1개</p>
                    <p class="price">31,000원</p>
                  </div>
                </div>
              </div>

            </div>
          </div>

          <div class="reason">
            <div class="L">
              <p>반품 완료일</p>
              <p>반품 요청일</p>
              <p>반품 사유</p>
              <p>상세 사유</p>
            </div>
            <div class="R">
              <p>2020.09.24</p>
              <p>2020.09.24</p>
              <p>단순 변심</p>
              <p class="memo">사유반품 상세사유반품 상세사유반품 상세사유반품 상세사유반품 상세사유반품 상세사유반품 상세사유반품 상세사유</p>
            </div>
          </div>

          <div class="photo">
            <div class="tit">
              <p>사진</p>
              <div class="btn">
                <p><img src="img/camera_02.png" alt="카메라이미지"></p>
                <p>첨부</p>
              </div>
            </div>
            <div class="img">
              <div class="img_inner">
                <p><img src="img/close-02.png" alt="삭제버튼이미지"></p>
                <p><img src="img/210-1.png" alt="첨부파일이미지"></p>
              </div>
            </div>
          </div>

          <div class="refund">
            <div class="tit">
              <p>환불 예정금액</p>
            </div>
            <div class="price">
              <div class="ctn">
                <p>최종 환불 예정금액</p>
                <p class="price">68,000원</p>
              </div>
              <div class="ctn">
                <p>환불 요청금액</p>
                <p>68,000원</p>
              </div>
              <div class="ctn">
                <p>상품 금액</p>
                <p>68,000원</p>
              </div>
            </div>
          </div>

        </div>

      </div>
      <!-- my page 주문 · 배송에 반품정보 끝 -->

      <!-- my page 구매내역 시작 -->
      <div id="purchaseHistory">
        <div id="purchaseHistory_header">
          <div class="inner">
            <p><img src="img/chevron-left-02.png" alt="돌아가기"></p>
            <div class="text">구매내역</div>
          </div>
        </div>

        <div id="purchaseHistory_contents"></div>
      </div>
      <!-- my page 구매내역 끝 -->

      <!-- my page 구매확정하시겠습니까 시작 -->
      <div id="confirmation"></div>

      <!-- my page 구매확정하시겠습니까 끝 -->

      <!-- my page 리뷰쓰기 시작 -->
      <div id="WReview"></div>
      <!-- my page 리뷰쓰기 끝 -->
  
      <!-- my page 공지사항 시작 -->
      <div id="notice">
        <div id="notice_header">
          <div class="inner">
            <p><img src="img/chevron-left-02.png" alt="돌아가기"></p>
            <div class="text">공지사항</div>
          </div>
        </div>
        <div id="notice_contents"></div>
      </div>
      <!-- my page 공지사항 끝 -->
    
      <!-- my page 나의정보 시작 -->
      <div id="myInfo">
        <div id="myInfo_header">
          <div class="inner">
            <p><img src="img/chevron-left-02.png" alt="돌아가기"></p>
            <div class="text">나의 정보</div>
          </div>
        </div>

        <div id="myInfo_contents">
          <div class="address">
            <div class="tit">
              <p>배송지 정보</p>
            </div>

            <div class="info">
              <div class="inner">
                <p class="text">수령인</p>
                <div><input type="text" id="my_name" name="text" placeholder="이름"></div>
              </div>
              <div class="inner">
                <p class="text">휴대폰</p>
                <div class="countryCode">
                  <select id="country_code"></select>
                  <p><input type="text" id="my_phone_number" name="number" placeholder="휴대폰"></p>
                </div>
              </div>
              <div class="inner">
                <p class="text">우편번호</p>
                <div class="zipCode">
                  <p class="code"><input type="text" id="my_zipcode" name="number" placeholder="우편번호" readonly></p>
                </div>
              </div>
              <div class="inner">
                <p class="text">주소지</p>
                <div class="addressInfo">
                  <p><input type="text" id="my_address" name="number" placeholder="주소지" readonly></p>
                  <p class="infoChange" onclick=address_change();>주소변경</p>
                </div>
              </div>
              <div class="inner">
                <p class="text">상세주소</p>
                <div><input type="text" id="my_detailed_address" name="text" placeholder="상세주소"></div>
              </div>
            </div>
          </div>
          <div class="myInfo_btn" onclick=information_change();>변경하기</div>
        </div>
      </div>
      <!-- my page 나의정보 시작 -->

      <!-- home 주소변경 시작 -->
      <div id="address">
        <div id="address_header">
          <div class="inner">
            <p><img src="img/chevron-left-02.png" alt="돌아가기"></p>
            <div class="text">주소변경</div>
          </div>
        </div>

        <div id="address_contents">
          <input type="text" id="sample2_postcode" placeholder="우편번호" readonly>
          <input type="button" onclick="sample2_execDaumPostcode()" value="주소검색"><br>
          <input type="text" id="sample2_address" placeholder="주소" readonly><br>
          <input type="button" id="btn" value="저장" onclick=save_information();><br>
          <input type="text" style="display: none;" id="sample2_detailAddress" placeholder="상세주소">
          <input type="text" style="display: none;" id="sample2_extraAddress" placeholder="참고항목">
              

          <!-- iOS에서는 position:fixed 버그가 있음, 적용하는 사이트에 맞게 position:absolute 등을 이용하여 top,left값 조정 필요 -->
          <div id="layer" style="display:none;position:fixed;overflow:hidden;z-index:1;-webkit-overflow-scrolling:touch;">
            <img src="img/close_01.png" id="btnCloseLayer" style="cursor:pointer;position:absolute;right:-3px;top:-3px;z-index:1" onclick="closeDaumPostcode()" alt="닫기 버튼">
          </div>
          <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
        </div>

      </div>
      <!-- home 주소변경 끝 -->

    </div>
 </body>
</html>

<script>
    var pk_id = 0;
    var my_name = "";
    var my_g_code = "";
    var my_phone_number = "";
    var my_zip_code = "";
    var my_address = "";
    var my_detailed_address = "";
    var result = 0;
    var element_layer = document.getElementById('layer');
    var img_path = "../img/user/";
    var review_score = 0;

    u_ck_cookie();

    // 쿠키 검색
    function u_ck_cookie(){
        var data = {
            result: 'u_ck_cookie' 
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    pk_id = json_data.message;
                    my_name = json_data.name;
                    my_address = json_data.address;
                    my_g_code = json_data.g_code;
                    my_phone_number = json_data.phone_number;
                    my_zip_code = json_data.zip_code;
                    my_detailed_address = json_data.detailed_address;
                    result = getParameterByName("result");
                    if(result == 110){
                        my_information();
                    }else if(result == 111){
                        order_delivery();
                    }

                    select_list();
                }else{ 
                  if(json_data.message == "FAIL"){ $("#prompt").html('<p>서버에러 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); } 
                  else if(json_data.message == 0){ location.href="shoppingMall1_home.html"; }
                }
                var data2 = {
                    result: 'u_select_country'
                }

                $.ajax({
                    type: 'POST',
                    url: '../user_db.php',
                    dataType: 'text',
                    data: data2,
                    success: function(data){
                        var json = JSON.parse(data);
                        if(json.code == 1){
                            var mess = JSON.parse(json.message);
                            var html = '';
                            for(var i=0; i<mess.length; i++){
                                if(my_g_code == mess[i].code){ html += '<option value="'+mess[i].code+'" selected>'+mess[i].code+'</option>'; }
                                else{ html += '<option value="'+mess[i].code+'">'+mess[i].code+'</option>'; }
                            }
                            $("#country_code").html(html);
                        }else{
                            if(json.message == "FAIL"){ $("#prompt").html('<p>서버에러 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                            else if(json.message == "NoData"){  }
                        }
                    },
                    error: function(err){
                        $("#prompt").html('<p>서버에러 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
                    }
                });
            },
            error: function(err){
                $("#prompt").html('<p>서버에러 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    // 리스트 가져오기
    function select_list(){
        var data = {
            pk_id: pk_id,
            result: 'u_select_list'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var message = JSON.parse(json_data.message);
                    var html = '';
                    if(message.p_name == "" || message.p_name == null || message.p_name == undefined){ html += '<p>XXX님 안녕하세요!</p><p>'+message.email+'</p>'; }
                    else{ html += '<p>'+message.p_name+'님 안녕하세요!</p><p>'+message.email+'</p>'; }
                    $("#title").html(html);
                }else{
                    if(json_data.message == "FAIL"){ $("#prompt").html('<p>서버에러 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                    else if(json_data.message == "NO"){  }
                }
            },
            error: function(err){
                $("#prompt").html('<p>서버에러 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    // 나의정보 클릭시
    function my_information(){
        if(my_name != 0 && my_name != ""){
            $("#my_name").val(my_name);
        }
        if(my_phone_number != 0 && my_phone_number != ""){
            $("#my_phone_number").val(my_phone_number);
        }
        if(my_zip_code != 0 && my_zip_code != ""){
            $("#my_zipcode").val(my_zip_code);
        }
        if(my_address != 0 && my_address != ""){
            $("#my_address").val(my_address);
        }
        if(my_detailed_address != 0 && my_detailed_address != ""){
            $("#my_detailed_address").val(my_detailed_address);
        }
    
        $('#myInfo').stop(true).animate({left:'0'},200);
        $('html, body').css({'overflow': 'hidden', 'height': '100%'});
    }

    // 주소변경 클릭시
    function address_change(){
        $('#address').stop().animate({left:'0'},200);
        $('html, body').css({'overflow': 'hidden', 'height': '100%'});
    }

    // 최종 주소 변경 완료 버튼
    function save_information(){
        if($("#sample2_postcode").val() == ""){
            $("#prompt").html('<p>주소를 입력하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            return;
        }
        if($("#sample2_address").val() == ""){
            $("#prompt").html('<p>주소를 입력하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            return;
        }
        $("#my_zipcode").val($("#sample2_postcode").val().trim());
        $("#my_address").val($("#sample2_address").val().trim());

        $('#address').stop().animate({left:'100%'},200);
		    $('html, body').css({'overflow': 'auto', 'height': '100%'});
    }

    // 변경시
    function information_change(){
        var my_name = $("#my_name").val().trim();
        var my_phone_number = $("#my_phone_number").val().trim();
        var my_zipcode = $("#my_zipcode").val().trim();
        var my_address = $("#my_address").val().trim();
        var my_detailed_address = $("#my_detailed_address").val().trim();

        if(my_name == ""){
            $("#prompt").html('<p>이름을 입력하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            return;
        }
        if(my_phone_number == ""){
            $("#prompt").html('<p>휴대폰 번호를 입력하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            return;
        }
        if(my_zipcode == ""){
            my_zipcode = "000000";
        }
        if(my_address == ""){
            $("#prompt").html('<p>주소를 입력하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            return;
        }
        if(my_detailed_address == ""){
            $("#prompt").html('<p>상세 주소를 입력하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            return;
        }

        var data = {
            my_name: my_name,
            my_phone_number: my_phone_number,
            my_zipcode: my_zipcode,
            my_address: my_address,
            my_detailed_address: my_detailed_address,
            country_code: $('#country_code option:selected').val(),
            pk_id: pk_id,
            result: 'u_information_change'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    $("#prompt").html('<p>변경완료 되었습니다.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
                    $('#myInfo').stop(true).animate({left:'100%'},200);
		                $('html, body').css({'overflow': 'auto', 'height': '100%'});
                }else{ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
            },
            error: function(err){
              $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    // get 파라미터 받아오기
    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
        return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    // 주문배송 클릭스
    function order_delivery(){
        var data = {
            pk_id: pk_id,
            result: 'u_order_delivery'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var message = JSON.parse(json_data.message);
                    var html = '';
                    for(var i=0; i<message.length; i++){
                        var date = new Date(message[i].insert_time * 1000);
                        var time = date.getFullYear().toString() + "-" + (date.getMonth() + 1).toString() + "-" + date.getDate().toString() + " " + date.getHours().toString() + ":" + date.getMinutes().toString() + ":" + date.getSeconds().toString();
                        var product_name = message[i].product_name;
                        if(product_name.length > 10){ product_name = product_name.substring(0,10); }
                        html += '<div class="product">';
                        html += '  <div class="shop">';
                        html += '    <div class="tit">';
                        html += ' <div class="collect">';
                        if(message[i].type == 1){ html += '<p>택배 대기중...</p>'; }
                        else{ html += '<p>택배 배송중...</p>'; }
                        html += ' </div>';
                        html += '  </div>';
                        html += ' <div class="call" onclick=order_detail('+message[i].pk_id+');>';
                        html += '   <p class="text">상세내역</p>';
                        html += ' </div>';
                        html += '  </div>';
                        html += ' <div class="product_list">';
                        html += '  <div class="details">';
                        html += '    <div class="product_img">';
                        html += '         <img src="'+img_path+'main/thum_'+message[i].main_img+'" alt="상품이미지">';
                        html += '   </div>';
                        html += '<div class="product_text">';
                        html += '  <div class="text_1">';
                        html += '   <div>';
                        html += '    <p>'+time+'</p>';
                        html += '  <p>'+product_name+'</p>';
                        html += '</div>';
                        html += '</div>';
                        html += '<div class="text_2">';
                        html += '  <p class="price">$'+parseFloat(message[i].product_price).toFixed(0)+'</p>';
                        html += ' </div>';
                        html += '</div>';
                        html += ' </div>';
                        if(message[i].type == 2){ html += ' <div class="received" onclick=completion_receipt('+message[i].pk_id+');><p>수령완료</p></div>'; }
                        html += ' </div>';
                        html += '</div>';
                    }
                    $("#delivery_contents").html(html);
                }else{
                    if(json_data.message == "FAIL"){ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                    else if(json_data.message == "NoData"){
                        var html = '';
                        html += '<div class="preparing" id="preparing_id">';
                        html += '    <div class="ctn" style="text-align: center;">';
                        html += '        <p><img src="img/product.png" alt="상품준비중이미지"></p>';
                        html += '        <p>♡ ~ 내용이 없습니다 ~ ♡</p>';
                        html += '     </div>';
                        html += '</div>';
                        $("#delivery_contents").html(html);
                    }
                }
                $('#delivery').stop().animate({left:'0'},200);
	 	            $('html, body').css({'overflow': 'hidden', 'height': '100%'});
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
        
    }

    // 주문배송 상세보기
    function order_detail(j_pk_id){
        var data = {
            j_pk_id: j_pk_id,
            result: 'u_order_detail'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var message = JSON.parse(json_data.message);
                    var html = '';
                    var date = new Date(message.insert_time * 1000);
                    var time = date.getFullYear().toString() + "-" + (date.getMonth() + 1).toString() + "-" + date.getDate().toString() + " " + date.getHours().toString() + ":" + date.getMinutes().toString() + ":" + date.getSeconds().toString();
                    html += '<div class="product">';
                    html += '    <div class="shop">';
                    html += '     <div class="tit">';
                    html += '       <p><img src="../img/company/main/imgthum/'+message.company_img_2+'" alt="샵이미지"></p>';
                    html += '    <div class="collect">';
                    html += '       <label for="chk">'+message.company_name+'</label>';
                    html += '      </div>';
                    html += '    </div>';
                    html += '   </div>';
                    html += '   <div class="product_list">';
                    html += '     <div class="details">';
                    html += '      <div class="product_img">';
                    html += '   <img src="'+img_path+'main/thum_'+message.main_img+'" alt="상품이미지">';
                    html += '    </div>';
                    html += '<div class="product_text">';
                    html += '  <div class="text_1">';
                    html += '   <div>';
                    html += '  <p>'+time+'</p>';
                    html += '  <p>'+message.product_name+'</p>';
                    html += '<p>'+message.product_explanation+'</p>';
                    html += ' </div>';
                    html += '  </div>';
                    html += '<div class="text_2">';
                    html += '   <p>'+message.quantity+'개</p>';
                    html += '    <p class="price">$'+parseFloat(message.product_price).toFixed(0)+'</p>';
                    html += '   </div>';
                    html += '   </div>';
                    html += '  </div>';
                    html += '  </div>';
                    html += ' </div>';
                    html += '<div class="address">';
                    html += ' <div class="tit">';
                    html += '   <p>배송지 정보</p>';
                    html += '  </div>';
                    html += '  <div class="info">';
                    html += '  <div class="inner">';
                    html += '  <p class="text">수령인</p>';
                    html += '  <div>'+message.recipient+'</div>';
                    html += ' </div>';
                    html += ' <div class="inner">';
                    html += ' <p class="text">휴대폰</p>';
                    html += '  <div class="countryCode">';
                    html += '    <p>'+message.code+' | '+message.phone_number+'</p>';
                    html += '   </div>';
                    html += '   </div>';
                    html += '<div class="inner">';
                    html += '  <p class="text">주소지</p>';
                    html += '    <div>'+message.address+'</div>';
                    html += '    </div>';
                    html += ' <div class="inner">';
                    html += '    <p class="text">상세주소</p>';
                    html += '   <div>'+message.detailed_address+'</div>';
                    html += '  </div>';
                    if(message.type == 2){
                        html += ' <div class="inner">';
                        html += '    <p class="text">택배사</p>';
                        html += '   <div>'+message.delivery_name+'</div>';
                        html += '  </div>';
                        html += ' <div class="inner">';
                        html += '    <p class="text">송장번호</p>';
                        html += '   <div>'+message.invoice_number+'</div>';
                        html += '  </div>';
                    }
                    html += '  <div class="memo">';
                    html += ' <textarea rows="5" name="memo" disabled>'+message.contents+'</textarea>';
                    html += '  </div>';
                    html += '  </div>';
                    html += '   </div>';
                    $("#purchaseDetails_contents").html(html);
                }else{ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                $('#purchaseDetails').stop().animate({left:'0'},200);
		            $('html, body').css({'overflow': 'hidden', 'height': '100%'});
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    // 주문배송 수령완료 클릭시
    function completion_receipt(j_pk_id){
        var data = {
            j_pk_id: j_pk_id,
            result: 'u_completion_receipt'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    order_delivery();
                }else{ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    // 구매내역 클릭시
    function purchase_history(){
        var data = {
            pk_id: pk_id,
            result: 'u_purchaseHistory_contents'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var message = JSON.parse(json_data.message);
                    var html = '';
                    for(var i=0; i<message.length; i++){
                        var date = new Date(message[i].insert_time * 1000);
                        var time = date.getFullYear().toString() + "-" + (date.getMonth() + 1).toString() + "-" + date.getDate().toString() + " " + date.getHours().toString() + ":" + date.getMinutes().toString() + ":" + date.getSeconds().toString();
                        var product_name = message[i].product_name;
                        var product_explanation = message[i].product_explanation;
                        if(product_name.length > 10){ product_name = product_name.substring(0,10); }
                        if(product_explanation.length > 15){ product_explanation = product_explanation.substring(0,15) + "..."; }
                        html += '<div class="product">';
                        html += '  <div class="shop">';
                        html += '    <div class="tit">';
                        html += '       <p><img src="../img/company/main/imgthum/'+message[i].company_img_2+'" alt="샵이미지"></p>';
                        html += '     <div class="collect">';
                        html += '        <label for="chk">'+message[i].company_name+'</label>';
                        html += '       </div>';
                        html += '      </div>';
                        html += '    </div>';
                        html += '  <div class="product_list">';
                        html += '      <div class="details">';
                        html += '          <div class="product_img" onclick=send_page1('+message[i].product_id+');>';
                        html += '             <img src="'+img_path+'main/thum_'+message[i].main_img+'" alt="상품이미지">';
                        html += '       </div>';
                        html += '        <div class="product_text">';
                        html += '        <div class="text_1">';
                        html += '         <div>';
                        html += '         <p>'+time+'</p>';
                        html += '        <p>'+product_name+'</p>';
                        html += '      <p>'+product_explanation+'</p>';
                        html += '    </div>';
                        if(message[i].order_status == 1){ html += '<p class="confirmation">미정</p>'; }
                        else if(message[i].order_status == 2){ html += '<p class="confirmation">구매확정</p>'; }
                        else if(message[i].order_status == 3){ html += '<p class="confirmation">반품</p>';  }
                        html += '     </div>';
                        html += '   <div class="text_2">';
                        html += '      <p>'+message[i].quantity+'개</p>';
                        html += ' <p class="price">$'+parseFloat(message[i].product_price).toFixed(0)+'</p>';
                        html += '     </div>';
                        html += '       </div>';
                        html += '   </div>';
                        html += ' <div class="btn">';
                        if(message[i].order_status == 1){
                            html += '  <p class="rvbtn" onclick=confirmation_purchase_2('+message[i].pk_id+');>구매확정</p>';
                            html += '  <p class="buyback" onclick=return_request('+message[i].pk_id+');>반품요청</p>';
                        }else if(message[i].order_status == 2){
                            html += '  <p class="rvbtn" onclick=add_review222('+message[i].pk_id+');>리뷰쓰기</p>';
                            html += '  <p class="buyback" onclick=send_page1('+message[i].product_id+');>재구매</p>';
                        }
                        html += '        </div>';
                        html += '       </div>';
                        html += ' </div>';
                    }
                    $("#purchaseHistory_contents").html(html);
                }else{
                    if(json_data.message == "FAIL"){ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                    else if(json_data.message == "NoData"){
                        var html = '';
                        html += '<div class="preparing" id="preparing_id">';
                        html += '    <div class="ctn" style="text-align: center;">';
                        html += '        <p><img src="img/product.png" alt="상품준비중이미지"></p>';
                        html += '        <p>♡ ~ 내용이 없습니다 ~ ♡</p>';
                        html += '     </div>';
                        html += '</div>';
                        $("#purchaseHistory_contents").html(html);
                    }
                }
                $('#purchaseHistory').stop().animate({left:'0'},200);
                $('html, body').css({'overflow': 'hidden', 'height': '100%'});
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    // 구매확정 사이드
    function confirmation_purchase_2(j_pk_id){
        var html = '';
        html += '<div class="inner">';
        html += '    <p class="tit">구매확정하시겠습니까?</p>';
        html += '    <div class="selectionBtn">';
        html += '      <p class="L" onclick=confirmation_purchase('+j_pk_id+')>예</p>';
        html += '      <p class="R" onclick=no_confirmation();>아니요</p>';
        html += '     </div>';
        html += ' </div>';
        $("#confirmation").html(html);
        $('#confirmation').stop().animate({top:'0'},200);
        $('html, body').css({'overflow': 'hidden', 'height': '100%'});
    }

    // 구매확정 취소버튼
    function no_confirmation(){
        $('#confirmation').stop().animate({top:'100%'},200);
		    $('html, body').css({'overflow': 'auto', 'height': '100%'});
    }
    
    // 구매확정 버튼
    function confirmation_purchase(j_pk_id){
        var data = {
            j_pk_id: j_pk_id,
            result: 'u_confirmation_purchase'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    purchase_history();
                }else{ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                $('#confirmation').stop().animate({top:'100%'},200);
		            $('html, body').css({'overflow': 'auto', 'height': '100%'});
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    // 구매내역 뒤로가기
    function purchase_hide(){
        $('#purchaseHistory').stop().animate({left:'100%'},200);
		    $('html, body').css({'overflow': 'auto', 'height': '100%'});
    }
 
    // 리뷰 쓰기
    function add_review222(j_pk_id){
        var data = {
            j_pk_id: j_pk_id,
            result: 'u_add_review'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var message = JSON.parse(json_data.message);
                    var html = '';
     
                    var date = new Date(message.update_time * 1000);
                    var time = date.getFullYear().toString() + "-" + (date.getMonth() + 1).toString() + "-" + date.getDate().toString() + " " + date.getHours().toString() + ":" + date.getMinutes().toString() + ":" + date.getSeconds().toString();
                    var product_name = message.product_name;
                    var product_explanation = message.product_explanation;
                    if(product_name.length > 10){ product_name = product_name.substring(0,10); }
                    if(product_explanation.length > 15){ product_explanation = product_explanation.substring(0,15) + "..."; }
                    html += '<form name="form_add_review" id="form_add_review" method="post" action="../user_db.php" enctype="multipart/form-data" onsubmit="return review_add(this);">'; 
                    html += '  <input type="hidden" name="result" value="u_form_add_review">';
                    html += '  <input type="hidden" name="pk_id" value="'+pk_id+'">';
                    html += '  <input type="hidden" name="j_pk_id" value="'+message.product_id+'">';
                    html += '  <input type="hidden" name="review_score" value="'+review_score+'" id="review_score_input_id">';
                    html += '  <input type="hidden" name="i_title" value="'+message.product_name+'">';
                    html += '<div id="WReview_header">';
                    html += '<div class="inner">';
                    html += '<div class="text">리뷰쓰기</div>';
                    html += ' </div>';
                    html += '</div>';
                    html += ' <div id="WReview_contents">';
                    html += '<div class="product">';
                    html += ' <div class="shop">';
                    html += ' <p><img src="../img/company/main/imgthum/'+message.company_img_2+'" alt="샵이미지"></p>';
                    html += ' <div class="collect">';
                    html += '  <label for="chk">'+message.company_name+'</label>';
                    html += '   </div>';
                    html += '  </div>';
                    html += '<div class="product_list">';
                    html += '<div class="details">';
                    html += '  <div class="product_img">';
                    html += '  <img src="'+img_path+'main/thum_'+message.main_img+'" alt="상품이미지">';
                    html += '  </div>';
                    html += '  <div class="product_text">';
                    html += '<p>'+time+'</p>';
                    html += ' <p>'+product_name+'</p>';
                    html += '<p>'+product_explanation+'</p>';
                    html += ' <p>'+message.quantity+'개</p>';
                    html += ' </div>';
                    html += '  </div>';
                    html += '</div>';
                    html += '  </div>';
                    html += ' <div class="score">';
                    html += '  <p class="tit">상품은 만족하셨나요?</p>';
                    html += ' <div class="img">';
                    html += ' <img src="img/score_2.png" onclick=review_score1(1); id="score_1_img">';
                    html += ' <img src="img/score_2.png" onclick=review_score1(2); id="score_2_img">';
                    html += ' <img src="img/score_2.png" onclick=review_score1(3); id="score_3_img">';
                    html += ' <img src="img/score_2.png" onclick=review_score1(4); id="score_4_img">';
                    html += ' <img src="img/score_2.png" onclick=review_score1(5); id="score_5_img">';
                    html += ' </div>';
                    html += ' </div>';
                    html += '<div class="rvtext">';
                    html += '<p class="rvtit">리뷰쓰기</p>';
                    html += ' <div>';
                    html += '  <textarea rows="5" name="i_content_text" placeholder="내용을 입력해 주세요" id="i_content_text"></textarea>';
                    html += ' </div>';
                    html += '<p>0/500</p>';
                    html += '  </div>';
                    html += '  <div class="photo">';
                    html += '   <div class="tit">';
                    html += '<div class="btn">';
                    html += '<div class="filebox bs3-primary">';
                    html += '<input class="upload-name" placeholder="파일 선택">';
                    html += '<label for="ex_filename">업로드</label>';
                    html += '<input type="file" id="ex_filename" name="ex_filename" class="upload-hidden">';
                    html += '</div>';
                    $(document).ready(function() {
                        var fileTarget = $('.filebox .upload-hidden');
                        fileTarget.on('change', function() {
                            if (window.FileReader) {
                                var filename = $(this)[0].files[0].name;
                            } else {
                                var filename = $(this).val().split('/').pop().split('\\').pop();
                            }
                            $(this).siblings('.upload-name').val(filename);
                        });
                    });
                    html += ' </div>';
                    html += '  </div>';
                    html += ' </div>';
                    html += ' <div class="footer_btn">';
                    html += ' <p class="cancel" onclick=review_cancel();>취소</p>';
                    html += ' <p class="enrollment"><input class="btn btn-block btn-primary" type="submit" value="등록"></p>';
                    html += ' </div>';
                    html += ' </div>';
                    html += '</form>';                    
                    $("#WReview").html(html);
                }else{ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }

                $('#WReview').stop().animate({left:'0'},200);
                $('html, body').css({'overflow': 'hidden', 'height': '100%'});
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
        
    }

    // 리뷰쓰기 취소 버튼 
    function review_cancel(){
        $('#WReview').stop().animate({left:'100%'},200);
        $('html, body').css({'overflow': 'auto', 'height': '100%'});
    }

    // 리뷰 점수주기 버튼클릭식
    function review_score1(result){
        review_score = result;
        $("#review_score_input_id").val(result);
        for(var i=1; i<=5; i++){ $("#score_"+i+"_img").attr("src","img/score_2.png"); }
        for(var i=1; i<=result; i++){ $("#score_"+i+"_img").attr("src","img/score_1.png"); }
    }

    // 리뷰 쓰기 버튼
    function review_add(){
        var i_content_text = $("#i_content_text").val().trim();
        var ex_filename = document.getElementById("ex_filename").value;
        var img_array = new Array('jpg', 'jpeg', 'png');
        var return_ck = 0;
        if(i_content_text == ""){
            $("#prompt").html('<p>리뷰 내용을 입력하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            return false;
        }
        if(ex_filename == ""){
            return_ck = 1;
        }else{
            var checkExt_img1 = false;
            var ext_img1 = ex_filename.slice(ex_filename.indexOf(".") + 1).toLowerCase();
            for (var i = 0; i < img_array.length; i++) {
                if (ext_img1 == img_array[i]) {
                    checkExt_img1 = true;
                    break;
                }
            }

            if (checkExt_img1 == false) {
                $("#prompt").html('<p>업로드 할수없는 확장자 입니다. 이미지 파일(jpg, jpeg, png)만 업로드 가능합니다.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
                return false;
            }else{
                return_ck = 1;
            }
        }

        if(return_ck == 0){
            return false;
        }else{
            $('#WReview').stop().animate({left:'100%'},200);
            $('html, body').css({'overflow': 'auto', 'height': '100%'});
            form_add_review.submit();
        }
    }

    // 자주 하는질문 클릭시
    function notice_history(){
        var data = {
            result: 'u_notice'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var message = JSON.parse(json_data.message);
                    var html = '';
                    for(var i=0; i<message.length; i++){
                        html += '<div class="notice_list">';
                        html += '  <div class="container">';
                        html += ' <div class="ctn1">';
                        html += '   <p class="text">'+message[i].title+'</p>';
                        html += '  </div>';
                        html += '<div class="ctn2">';
                        html += '  <p class="text">'+message[i].content+'</p>';
                        html += ' </div>';
                        html += '</div>';
                        html += '</div>';
                    }
                    $("#notice_contents").html(html);
                }else{
                    if(json_data.message == "FAIL"){ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                    else if(json_data.message == "NoData"){
                        var html = '';
                        html += '<div class="preparing" id="preparing_id">';
                        html += '    <div class="ctn" style="text-align: center;">';
                        html += '        <p><img src="img/product.png" alt="상품준비중이미지"></p>';
                        html += '        <p>♡ ~ 내용이 없습니다 ~ ♡</p>';
                        html += '     </div>';
                        html += '</div>';
                        $("#notice_contents").html(html);
                    }
                }
                $('#notice').stop(true).animate({left:'0'},200);
		            $('html, body').css({'overflow': 'hidden', 'height': '100%'});
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        }); 
    }

    // 공지사항
    function notice_history_2(){
        var data = {
            result: 'u_notice_2'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var message = JSON.parse(json_data.message);
                    var html = '';
                    for(var i=0; i<message.length; i++){
                      html += '<div class="notice_list">';
                      html += '  <div class="container">';
                      html += ' <div class="ctn1">';
                      html += '   <p class="text">'+message[i].title+'</p>';
                      html += '  </div>';
                      html += '<div class="ctn2">';
                      html += '  <p class="text">'+message[i].content+'</p>';
                      html += ' </div>';
                      html += '</div>';
                      html += '</div>';
                    }
                    $("#notice_contents").html(html);
                }else{
                    if(json_data.message == "FAIL"){ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                    else if(json_data.message == "NoData"){
                        var html = '';
                        html += '<div class="preparing" id="preparing_id">';
                        html += '    <div class="ctn" style="text-align: center;">';
                        html += '        <p><img src="img/product.png" alt="상품준비중이미지"></p>';
                        html += '        <p>♡ ~ 내용이 없습니다 ~ ♡</p>';
                        html += '     </div>';
                        html += '</div>';
                        $("#notice_contents").html(html);
                    }
                }
                $('#notice').stop(true).animate({left:'0'},200);
		            $('html, body').css({'overflow': 'hidden', 'height': '100%'});
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        })
    }

    // 1페이지 상품 보내기
    function send_page1(j_product_id){
        location.href="shoppingMall1_home.html?j_product_id="+j_product_id;
    }

    // 반품 요청 보기
    function return_request(j_pk_id){
        var data = {
            j_pk_id: j_pk_id,
            result: 'u_return_request'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    var message = JSON.parse(json_data.message);
                    var delivery = JSON.parse(json_data.delivery);
                    var html = '';
                    var date = new Date(message.insert_time * 1000);
                    var time = date.getFullYear().toString() + "-" + (date.getMonth() + 1).toString() + "-" + date.getDate().toString() + " " + date.getHours().toString() + ":" + date.getMinutes().toString() + ":" + date.getSeconds().toString();
                    var product_name = message.product_name;
                    if(product_name.length > 10){ product_name = product_name.substring(0,10) + "..."; }
                    var product_explanation = message.product_explanation;
                    if(product_explanation.length > 15){ product_explanation = product_explanation.substring(0,15) + "..."; }
                    html += '<div class="product">';
                    html += ' <div class="tit"><p>반품상품</p></div>';
                    html += '  <div class="product_list">';
                    html += '   <div class="details">';
                    html += '      <div class="product_img"><img src="'+img_path+'main/thum_'+message.main_img+'" alt="상품이미지"></div>';
                    html += '      <div class="product_text">';
                    html += '      <div class="text_1">';
                    html += '         <div>';
                    html += '          <p>'+time+'</p>';
                    html += '           <p>'+product_name+'</p>';
                    html += '            <p>'+product_explanation+'</p>';
                    html += '           </div>';
                    html += '          </div>';
                    html += '         <div class="text_2">';
                    html += '     <p>'+message.quantity+'개</p>';
                    html += '     <p class="price">$'+parseFloat(message.product_price).toFixed(0)+'</p>';
                    html += '     </div>';
                    html += '    </div>';
                    html += '    </div>';
                    html += '   </div>';
                    html += '   </div>';
                    html += ' <div class="invoiceNo">';
                    html += '  <p class="tit">반품 정보입력</p>';
                    html += '  <div class="ctn">';
                    html += '   <div class="invoiceName">';
                    html += '  <p>택배사 이름</p>';
                    html += '  <select id="op">';
                    for(var i=0; i<delivery.length; i++){
                        html += '     <option value="'+delivery[i].pk_id+'">'+delivery[i].name+'</option>';
                    }
                    html += '   </select>';
                    html += ' </div>';
                    html += '  <div class="nb">';
                    html += '     <p>송장 번호</p>';
                    html += '   <div class="num"><input type="number" id="r_invoice_number" name="number" placeholder="송장번호를 입력해주세요"></div>';
                    html += '  </div>';
                    html += '  </div>';
                    html += '    </div>';
                    html += ' <div class="reason">';
                    html += ' <p class="tit">반품사유</p>';
                    html += ' <div class="text">';
                    html += '  <div class="memo">';
                    html += '   <textarea rows="5" name="memo" id="r_detailed_reason" placeholder="상세 사유를 입력해주세요"></textarea>';
                    html += '</div>';
                    html += ' <p class="character">0/500</p>';
                    html += '  </div>';
                    html += '   </div>';
                    html += ' <div class="contact">';
                    html += '   <p class="tit">반품정보(반품전 연락을 하시고 반품처리 하세요.)</p>';
                    html += '  <div class="ctn">';
                    html += '   <div class="L">';
                    html += '     <p>판매자 연락처: </p>';
                    html += '     <p>판매자 주소지: </p>';
                    html += ' </div>';
                    html += ' <div class="R">';
                    html += '   <p>'+message.company_contact+'</p>';
                    html += '  <p>'+message.company_address+'</p>';
                    html += ' </div>';
                    html += '</div>';
                    html += ' </div>';
                    html += ' <div class="cancel_btn" onclick=return_request_action('+message.pk_id+');><p>반품 요청하기</p></div>';
                    $("#return_contents").html(html);
                }else{ $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200); }
                $('#return').stop().animate({left:'0'},200);
                $('html, body').css({'overflow': 'hidden', 'height': '100%'});
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    // 반품 신청 클릭시
    function return_request_action(j_pk_id){
        var op = $('#op option:selected').val();
        var r_invoice_number = $("#r_invoice_number").val().trim();
        var r_detailed_reason = $("#r_detailed_reason").val().trim();

        if(r_invoice_number == ""){
            alert("송장 번호를 입력하세요.");
            return;
        }

        if(r_detailed_reason == ""){
            alert("반품 사유를 입력하세요.");
            return;
        }

        var data = {
            op: op,
            r_invoice_number: r_invoice_number,
            r_detailed_reason: r_detailed_reason,
            j_pk_id: j_pk_id,
            result: 'u_return_request_action'
        }

        $.ajax({
            type: 'POST',
            url: '../user_db.php',
            dataType: 'text',
            data: data,
            success: function(data){
                var json_data = JSON.parse(data);
                if(json_data.code == 1){
                    $("#prompt").html('<p>반품 신청 되었습니다.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
                    $('#return').stop().animate({left:'100%'},200);
                    $('html, body').css({'overflow': 'auto', 'height': '100%'});
                    purchase_history();
                }else{
                    $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
                }
            },
            error: function(err){
                $("#prompt").html('<p>서버 에러. 잠시후 다시 시도하세요.</p>'); $('#prompt').fadeIn(200).delay(1500).fadeOut(200);
            }
        });
    }

    /////////////////////////////////////////////////////////     주소 검색 /    /////////////////////////////////////////////////
    function closeDaumPostcode() {
        // iframe을 넣은 element를 안보이게 한다.
        element_layer.style.display = 'none';
    }

    function sample2_execDaumPostcode() {
        new daum
            .Postcode({
                oncomplete: function(data) {
                    // 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분. 각 주소의 노출 규칙에 따라 주소를 조합한다. 내려오는 변수가 값이 없는 경우엔
                    // 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                    var addr = ''; // 주소 변수
                    var extraAddr = ''; // 참고항목 변수

                    //사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
                    if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                        addr = data.roadAddress;
                    } else { // 사용자가 지번 주소를 선택했을 경우(J)
                        addr = data.jibunAddress;
                    }

                    // 사용자가 선택한 주소가 도로명 타입일때 참고항목을 조합한다.
                    if (data.userSelectedType === 'R') {
                        // 법정동명이 있을 경우 추가한다. (법정리는 제외) 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
                        if (data.bname !== '' && /[동|로|가]$/g.test(data.bname)) {
                            extraAddr += data.bname;
                        }
                        // 건물명이 있고, 공동주택일 경우 추가한다.
                        if (data.buildingName !== '' && data.apartment === 'Y') {
                            extraAddr += (
                                extraAddr !== '' ?
                                ', ' + data.buildingName :
                                data.buildingName
                            );
                        }
                        // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                        if (extraAddr !== '') {
                            extraAddr = ' (' + extraAddr + ')';
                        }
                        // 조합된 참고항목을 해당 필드에 넣는다.
                        document
                            .getElementById("sample2_extraAddress")
                            .value = extraAddr;

                    } else {
                        document
                            .getElementById("sample2_extraAddress")
                            .value = '';
                    }

                    // 우편번호와 주소 정보를 해당 필드에 넣는다.
                    document
                        .getElementById('sample2_postcode')
                        .value = data.zonecode;
                    document
                        .getElementById("sample2_address")
                        .value = addr;
                    // 커서를 상세주소 필드로 이동한다.
                    document
                        .getElementById("sample2_detailAddress")
                        .focus();

                    // iframe을 넣은 element를 안보이게 한다. (autoClose:false 기능을 이용한다면, 아래 코드를 제거해야 화면에서
                    // 사라지지 않는다.)
                    element_layer.style.display = 'none';
                },
                width: '100%',
                height: '100%',
                maxSuggestItems: 5
            })
            .embed(element_layer);

        // iframe을 넣은 element를 보이게 한다.
        element_layer.style.display = 'block';

        // iframe을 넣은 element의 위치를 화면의 가운데로 이동시킨다.
        initLayerPosition();
    }

    // 브라우저의 크기 변경에 따라 레이어를 가운데로 이동시키고자 하실때에는 resize이벤트나, orientationchange이벤트를 이용하여
    // 값이 변경될때마다 아래 함수를 실행 시켜 주시거나, 직접 element_layer의 top,left값을 수정해 주시면 됩니다.
    function initLayerPosition() {
        var width = 300; //우편번호서비스가 들어갈 element의 width
        var height = 400; //우편번호서비스가 들어갈 element의 height
        var borderWidth = 5; //샘플에서 사용하는 border의 두께

        // 위에서 선언한 값들을 실제 element에 넣는다.
        element_layer.style.width = width + 'px';
        element_layer.style.height = height + 'px';
        element_layer.style.border = borderWidth + 'px solid';
        // 실행되는 순간의 화면 너비와 높이 값을 가져와서 중앙에 뜰 수 있도록 위치를 계산한다.
        element_layer.style.left = (
            ((window.innerWidth || document.documentElement.clientWidth) - width) / 2 - borderWidth
        ) + 'px';
        element_layer.style.top = (
            ((window.innerHeight || document.documentElement.clientHeight) - height) / 2 - borderWidth
        ) + 'px';
    }
</script>